# 3EMA + MACD-V + Aroon Trend Following Strategy

A trend-following trading strategy for TQQQ (Triple-leveraged QQQ ETF) using an ensemble of three indicators: Triple EMA, MACD-Volume, and Aroon.

> **DISCLAIMER**: This is a personal experimentation project. I am not a professional trader, financial advisor, or licensed investment professional. This strategy is for educational and research purposes only. Past performance does not guarantee future results.

## Strategy Overview

This is a **trend-following** strategy that combines three technical indicators with **OR logic** (any indicator can trigger a signal):

### Strategy Components

1. **Triple EMA (3EMA)** - Fast (12), Medium (89), Slow (125) exponential moving averages
   - BUY: Any EMA crosses above another
   - SELL: Any EMA crosses below another

2. **MACD-Volume (MACD-V)** - Volume-confirmed MACD
   - BUY: MACD bullish cross + volume confirmation
   - SELL: MACD bearish cross + volume confirmation

3. **Aroon Indicator** - Trend strength indicator (length 66)
   - BUY: Aroon Up crosses above Aroon Down
   - SELL: Aroon Up crosses below Aroon Down

### Key Parameters

- **Triple EMA**: 12, 89, 125 periods
- **MACD-V**: Fast=25, Slow=30, Signal=85
- **Aroon Length**: 66 periods
- **Exit Strategy**: Exit only on opposite signal (no stop loss/take profit/holding period)

## Strategy Hypothesis

### Core Hypothesis

Leveraged ETFs like TQQQ exhibit **stronger momentum persistence** due to two key characteristics:

1. **Compounding Leverage**: TQQQ aims to deliver 3x the daily return of QQQ. During sustained trends, holding TQQQ compounds these leveraged returns over multiple days, creating outsized gains that exceed simple 3x leverage over longer holding periods.

2. **Asymmetric Performance**: During strong trending markets, TQQQ's 3x daily leverage compounds favorably. While leveraged ETFs are known for volatility decay during choppy markets, the amplified moves during strong trends create opportunities for trend-following strategies to capture significant returns.

3. **Ensemble Approach**: Using three complementary indicators (3EMA, MACD-V, Aroon) with OR logic allows the strategy to:
   - Capture trends earlier than single indicators
   - Reduce false signals through confirmation
   - Adapt to different market regimes (trending vs. ranging)

### Expected Behavior

The strategy aims to:
- **Enter**: When any indicator signals emerging upward momentum (trend initiation)
- **Hold**: Ride the amplified trend generated by TQQQ's leverage mechanics
- **Exit**: Only on reversal signals (opposite SELL signal), allowing full trend participation

This "no stop-loss" approach is theoretically justified for trend-following systems, as research suggests that cutting winners early reduces the strategy's edge (see Brock, Lakonishok & LeBaron, 1992).

## Research Foundation

### Empirical Evidence on Moving Average Strategies

The effectiveness of moving average crossover systems (the foundation of our 3EMA approach) has been validated in academic research:

1. **Nazario, Silva, & Rossi (2017)** - ["A Survey of Moving Average Trading Rules for the NASDAQ Composite Index"](https://www.sciencedirect.com/science/article/abs/pii/S0261560618301749)
   - Tested various EMA periods on NASDAQ data (1985-2015)
   - Found that longer-period EMAs (50+ days) capture significant medium-term trends
   - Demonstrated that multi-EMA systems reduce false signals compared to single EMA
   - Reported Sharpe ratios between 0.8-1.2 for optimized parameters

2. **Brock, Lakonishok, & LeBaron (1992)** - ["Simple Technical Trading Rules and the Stochastic Properties of Stock Returns"](https://www.jstor.org/stable/1998214)
   - Pioneering study on moving averages on the Dow Jones (1897-1986)
   - Confirmed profitability of MA crossover strategies over 90-year period
   - Found that intermediate-term moving averages (50-200 days) capture most significant trends
   - Established statistical significance after controlling for transaction costs and data snooping

3. **Metghalchi, Marcucci, & Chang (2008)** - ["Are Moving Average Trading Rules Profitable? Evidence from the European Stock Markets"](https://www.sciencedirect.com/science/article/abs/pii/S1062940808000983)
   - Tested MA strategies across European markets
   - Found consistent profitability across different market regimes
   - Demonstrated that trend-following strategies work during both trending and volatile periods

### MACD Indicator Effectiveness

The MACD (Moving Average Convergence Divergence) indicator has been studied for its predictive power:

1. **Fletcher & Hillier (2001)** - ["An Examination of trading Tactics Using the MACD"](https://www.jstor.org/stable/23528706)
   - Empirical study on MACD trading rules
   - Found MACD generates statistically significant returns in trending markets
   - Demonstrated that volume confirmation improves MACD performance
   - Showed MACD strategies outperform buy-and-hold during sustained trends

2. **Ballings, Van den Poel, & Hespeels (2015)** - ["Evaluating multiple classifiers for stock price direction prediction"](https://www.sciencedirect.com/science/article/abs/pii/S0950705115000253)
   - Included MACD in comprehensive technical analysis study
   - Found MACD among top performers for trend detection
   - Confirmed MACD's effectiveness when combined with volume indicators

3. **Levy (1967)** - ["Relative Strength as a Criterion for Investment Selection"](https://www.jstor.org/stable/2325866)
   - Early work on momentum indicators (foundation for MACD)
   - Demonstrated that price momentum persists over intermediate horizons
   - Established the theoretical basis for trend-following approaches

### Why These Indicators Work for Long-Term Trends

The academic literature suggests these indicators are effective for long-term trend following due to:

- **Trend Persistence**: Price momentum persists over 3-12 month horizons (Jegadeesh & Titman, 1993 - "Returns to Buying Winners and Selling Losers")
- **Economic Cycles**: Long-term EMAs (50-200 days) align with business cycle patterns
- **Volatility Clustering**: High volatility periods tend to cluster, making MA crossovers predictive
- **Behavioral Factors**: Investor herding and institutional trading create sustained price movements
- **Multiple EMA Advantages**: Using three EMAs provides earlier trend detection with reduced false signals (Nazario et al., 2017)

### Application to Leveraged ETFs

Leveraged ETFs like TQQQ are particularly well-suited for trend-following because:
- 3x daily leverage amplifies returns during sustained trends
- Compounding of leveraged returns over multiple days creates outsized gains during strong directional moves
- High volatility provides opportunities for significant returns when trends persist
- The strategy captures these amplified compounding effects during trends while limiting exposure during market reversals
- Trend-following helps avoid volatility decay periods common in choppy/range-bound markets

## Optimization Methodology

### Why Sortino Ratio for Long-Only Strategies

This strategy optimizes for the **Sortino ratio** rather than the Sharpe ratio, which is more appropriate for long-only trend-following strategies.

#### Sortino Ratio Definition

```
Sortino Ratio = (Return - Risk-Free Rate) / Downside Deviation
```

Where downside deviation only considers returns below a target (typically zero or risk-free rate).

#### Why Sortino Is Superior Here

1. **Asymmetric Risk Profile**: Long-only strategies have asymmetric risk:
   - **Upside**: Theoretically unlimited (to infinity)
   - **Downside**: Limited to -100% (total loss)
   
2. **Downside Focus**: For trend-following, we primarily care about:
   - Avoiding large drawdowns
   - Minimizing negative volatility
   - Capturing asymmetric returns (large winners, small losers)

3. **Sharpe Penalizes Both Directions**: The Sharpe ratio penalizes both upside and downside volatility equally, which is inappropriate for strategies with:
   - Positive skewness (many small losses, fewer large gains)
   - Leveraged underlying (TQQQ's inherent volatility)
   - Trend-following's asymmetric payoff structure

4. **TQQQ Context**: TQQQ's high volatility can produce high Sharpe ratios due to total volatility, but Sortino better captures the actual risk an investor faces (downside only).

#### Expected Results

The strategy's backtesting shows:
- **Sortino Ratio**: ~3.0 (higher than Sharpe due to asymmetric risk consideration)
- **Sharpe Ratio**: ~2.0 (penalizes both directions equally)
- The 50% improvement in Sortino vs. Sharpe indicates the strategy successfully generates returns with controlled downside

This optimization methodology aligns with research showing that risk-adjusted returns are best measured by downside risk metrics for asymmetric strategies.

## Strategy Performance

Based on backtesting from 2018-2025:

- **Total Return**: 1193.53% (in-sample), 329.39% (out-of-sample)
- **Sharpe Ratio**: 2.005 (in-sample), 1.869 (out-of-sample)
- **Sortino Ratio**: 3.099 (in-sample), 3.007 (out-of-sample) - *Optimization target*
- **Win Rate**: 70-73%
- **Profit Factor**: 5.75-6.45
- **Trades per Year**: ~4-5 trades

*Note: Sortino ratio is higher than Sharpe because it only penalizes downside volatility, reflecting the strategy's asymmetric risk profile.*

## Quick Start

### Installation

```bash
# Clone this repo
git clone https://github.com/KamvysisPuzzles/im-qqqooked.git
cd im-qqqooked

# Install dependencies
pip install -r requirements.txt

# Run backtest
python main.py --mode backtest
```

### Run Backtest

```bash
python main.py --mode backtest
```

This will:
- Download TQQQ historical data
- Run the strategy backtest
- Generate performance metrics
- Create visualizations in `results/`

### Run Live Monitoring (Manual Execution)

For live trading with Telegram alerts:

```bash
python main.py --mode live
```

**Note**: This generates signals for **manual execution** via Telegram alerts. You execute trades manually in your broker.

### Setup Telegram Alerts

1. Get your Telegram bot token from [@BotFather](https://t.me/botfather)
2. Get your chat ID from [@userinfobot](https://t.me/userinfobot)
3. Update `config/strategy_config.yaml`:

```yaml
live:
  enabled: true
  telegram_enabled: true
  telegram_bot_token: "YOUR_BOT_TOKEN"
  telegram_chat_id: "YOUR_CHAT_ID"
  signal_check_interval: 3600  # Check every hour
```

## Repository Structure

```
qqqooked/
├── notebooks/
│   ├── strategies/          # Strategy implementation notebooks
│   │   └── 3EMA_MACDV_Aroon.ipynb
│   └── analysis/            # Parameter optimization notebooks
│       ├── 3EMA.ipynb
│       ├── MACD.ipynb
│       └── Aroon.ipynb
├── src/
│   ├── strategy.py          # 3EMA + MACD-V + Aroon strategy
│   ├── data_fetcher.py     # Data fetching module
│   ├── backtest.py          # Backtesting engine
│   └── live_monitor.py     # Live signal monitoring
├── config/
│   └── strategy_config.yaml # Strategy configuration
├── results/                 # Backtest results & plots
├── logs/                    # Log files
└── main.py                  # Entry point
```

## Configuration

Edit `config/strategy_config.yaml` to customize:

```yaml
# Strategy Parameters
strategy:
  ema1: 12
  ema2: 89
  ema3: 125
  macd_fast: 25
  macd_slow: 30
  macd_signal: 85
  aroon_length: 66

# Risk Management
risk:
  stop_loss_pct: null    # Disabled - no stop loss
  take_profit_pct: null  # Disabled - no take profit
  max_holding_days: null # Disabled - no max holding period
```

## Strategy Logic

### Signal Generation (OR Logic)

The strategy generates BUY signals when **ANY** of the three indicators triggers:

1. **3EMA Signal**: Any EMA crosses above another
2. **MACD-V Signal**: MACD crosses above signal line + volume confirmation
3. **Aroon Signal**: Aroon Up crosses above Aroon Down

### Exit Logic

Positions exit on:
- **Opposite Signal**: Any SELL signal from indicators triggers exit
- No stop loss, take profit, or maximum holding period

### Position Management

- **Direction**: LONG only (trend-following)
- **Position Size**: 10% of portfolio
- **Maximum Positions**: 1 concurrent position
- **Exits**: Only on opposite signals (pure trend following)

## DISCLAIMER

**THIS IS NOT FINANCIAL ADVICE**

**Important**: I am not a professional trader, financial advisor, or licensed investment professional. This is a personal experimentation project for educational and research purposes only.

**Key Points**:
- This is a learning/research project, not a professional trading system
- Past performance does not guarantee future results
- Trading leveraged ETFs (like TQQQ) is highly risky and can result in significant losses
- Always do your own research and consult with qualified financial professionals
- Use at your own risk

**DO NOT RISK MORE THAN YOU CAN AFFORD TO LOSE**

This repository is shared for educational purposes only. If you use this strategy, you do so at your own risk. I am not responsible for any trading losses or financial damage that may result from using this code or strategy.

## Contributing

Feel free to:
- Report bugs
- Suggest improvements
- Share your results
- Fork and experiment!

## License

This project is for educational purposes only. Use at your own discretion.

---

**Strategy Type**: Trend Following  
**Target Instrument**: TQQQ (3x QQQ)  
**Market**: US Stock Market  
**Timeframe**: Daily bars  
**Execution**: Manual (via Telegram alerts)

**Good luck!**
